<!DOCTYPE html>
<html lang="pt-br">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Site informativo sobre HTTP - Trabalho de redes">
  <meta name="author" content="Beabelha">

  <!-- Titulo do site --> 
  <title>HTTPINFO - REST API</title>

  <!-- CSS DO DATA TABLE -->
  <!--   <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.css"> -->

  <!-- Bootstrap CSS -->
  <link href="scss/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.20/css/dataTables.bootstrap4.min.css">

  <!-- Fontes customizaveis -->
  <link href="https://fonts.googleapis.com/css?family=Saira+Extra+Condensed:500,700" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Muli:400,400i,800,800i" rel="stylesheet">
  <link href="scss/all.min.css" rel="stylesheet">

  <!-- CSS LOCAL -->
  <link href="css/resume.min.css" rel="stylesheet">

  <!-- ICONE (FAVICON) DO SITE -->
  <link href="img/favicon.ico" rel="icon" type="image/x-icon">

  <!-- JQUERY (para o funcionamento da datatable) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

  <!-- Script da DATATABLE --> 
  <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.js"></script>

</head>

<body id="page-top">
  <!-- Barra de navegação do site de pagina unica, acha as sessões pelo ID --> 
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top" id="sideNav">
    <a class="navbar-brand js-scroll-trigger" href="#page-top">
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link js-scroll-trigger" href="index.html">Voltar</a>
        </li>
        <li class="nav-item">
          <a class="nav-link js-scroll-trigger" href="#itens">Bora lá!</a>
        </li>
        <li class="nav-item">
          <a class="nav-link js-scroll-trigger" href="#awards"></a>
        </li>
      </ul>
    </div>
  </nav>

  <div class="container-fluid p-0">

    <section class="resume-section p-3 p-lg-5 d-flex align-items-center" id="inicio">
      <div class="w-100">
        <h1 class="mb-0">REST-
          <span class="text-primary">API</span>
        </h1>
        <div class="subheading mb-5">Consumindo a API :)
        </div>
      </div>
    </section>

    <hr class="m-0">

    <!-- Primeira sessão, o que é http --> 
    <section class="resume-section p-3 p-lg-5 d-flex justify-content-center" id="itens">
      <div class="w-100">

        <div class="resume-item d-flex flex-column flex-md-row justify-content-between mb-5">
          <div class="resume-content">


            <!-- DATA TABLE -->
            <div class="container">
              <div class="row">
                <div class="col-sm">
                  <div class="btn-group-vertical" role="group" aria-label="Basic example">
                    <button id="listar" type="button" class="btn btn-secondary">Listar</button>
                    <button id="listarUnico" type="button" class="btn btn-secondary">Listar Unico</button>
                    <button id="naoConsta" type="button" class="btn btn-secondary">Não consta</button>
                    <button id="listarRSC" type="button" class="btn btn-secondary">Listar (rsc)</button>
                    <button id="listarUnicoRSC" type="button" class="btn btn-secondary">Único (rsc)</button>
                    <button id="listarUnicoRSCEr" type="button" class="btn btn-secondary">Unico (rsc- 404)</button>
                    <button id="Criar" type="button" class="btn btn-secondary">Criar</button>
                    <button id="atualizarPost" type="button" class="btn btn-secondary">Atualizar - POST</button>
                    <button id="atualizarPatch" type="button" class="btn btn-secondary">Atualizar - Patch</button>
                    <button id="deletar" type="button" class="btn btn-secondary">Deletar</button>
                  </div>
                </div>
                <div id="colTable" class="col-md-8" style="display: none;">

                  <table id="dataTable" class="table table-borderless">
                    <thead>
                      <tr>
                      <!--     <th>ID</th>
                          <th>Nome</th>
                          <th>Sobrenome</th>
                          <th>Email</th> -->
                        </tr>
                      </thead>
                      <tbody id="tbody">

                      </tbody>
                    </table>


                  </div>
                  <div id="escondida" style="display: none;">
                    <table id="unico" class="table table-bordered">
                      <tbody>
                        <tr>
                          <td id="idU"></td>
                          <td id="nameU"></td>
                          <td id="lastnU"></td>
                          <td id="emailU"></td>
                          <td><img id="avatarU"></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <div id="form" style="display: none;">
                    <form method="POST">
                      <div class="form-group">
                        <label for="exampleInputEmail1">Nome</label>
                        <input name="nome" type="text" class="form-control" id="nome" aria-describedby="emailHelp">
                      </div>
                      <div class="form-group">
                        <label for="exampleInputEmail1">Sobrenome</label>
                        <input name="sobrenome" type="text" class="form-control" id="sobrenome" aria-describedby="emailHelp">
                      </div>
                      <div class="form-group">
                        <label for="exampleInputPassword1">Cargo</label>
                        <input name="trabalho" type="text" class="form-control" id="trabalho">
                      </div>
                      <button id="submit" type="submit" class="btn btn-primary">Cadastrar</button>
                    </form>    
                  </div>   
                  <span display="none" id="retornoErro"></span>
                  <span display="none" id="retornoCreate1"></span>
                  <span display="none" id="retornoCreate2"></span>

                </div>
              </div>

            </div>
          </div>

        </div>

      </div>

      <!-- Script da REST API -->

      <script type="text/javascript">
       var xhr = new XMLHttpRequest();


     //Listar todos os usuários
     document.getElementById("listar").onclick = function(){

      $( "#colTable" ).slideToggle( "slow", function() {
      });

      $.ajax({

        url: "https://reqres.in/api/users/2",
        type: "GET",

        success: function(response){
          $('#dataTable').DataTable( {
            ajax:  "https://reqres.in/api/users",
            columns: [
            { "data" : "first_name"},
            { "data" : "last_name"},
            { "data" : "email"},]
          });
        }
      });
    };

    //Listar usuário único
    document.getElementById("listarUnico").onclick = function(){


      $('#dataTable').dataTable().fnDestroy();
      $( "#colTable" ).slideToggle( "fast", function() {
      });


      $( "#escondida" ).toggle();



      $.ajax({
        url: "https://reqres.in/api/users/2",
        type: "GET",

        success: function (response) {
          $("#idU").text(response.data.id);
          $("#nameU").text(response.data.first_name);
          $("#lastnU").text(response.data.last_name);
          $("#avatarU").attr('src', response.data.avatar);
          $("#emailU").text(response.data.email);
        }
      });
    };

    document.getElementById("naoConsta").onclick = function () {

      document.getElementById("unico").innerHTML = null;

      $('#dataTable').dataTable().fnDestroy();

      $( "#returnoErro" ).slideToggle( "slow", function() {
      });
      $.ajax({
        url: "https://reqres.in/api/users/23",
        type: "GET",

        statusCode: {
          404: function () {
           $("#retornoErro").text("Usuário não consta no sistema");
           setTimeout(function(){ 
            $("#retornoErro").text("");
          }, 5000); 
         }
       }
     });
    };

         //Listar todos os usuários RESOURCE
         document.getElementById("listarRSC").onclick = function(){

           $('#dataTable').dataTable().fnDestroy();

           $( "#colTable" ).slideToggle( "slow", function() {
           });

           $.ajax({

            url: "https://reqres.in/api/unknowwn",
            type: "GET",

            success: function(response){
              $('#dataTable').DataTable( {
                ajax:  "https://reqres.in/api/unknowwn/",
                columns: [
                { "data" : "name"},
                { "data" : "color"},
                { "data" : "year"},]
              });
            }
          });
         };



         document.getElementById("listarUnicoRSC").onclick = function(){


          $('#dataTable').dataTable().fnDestroy();
          $( "#colTable" ).slideToggle( "fast", function() {
          });
          $( "#escondida" ).toggle();

          $.ajax({
            url: "https://reqres.in/api/unknowwn/2",
            type: "GET",

            success: function (response) {
              $("#nameU").text(response.data.name);
              $("#lastnU").text(response.data.color);
              $("#emailU").text(response.data.year);
            }
          });
        };



        document.getElementById("Criar").onclick = function(){
          $( "#colTable" ).slideToggle( "fast", function() {
          });
          $( "#form" ).slideToggle( "fast", function() {
          });
        };


        document.getElementById("submit").onclick = function () {

          $('#dataTable').dataTable().fnDestroy();
          $( "#form" ).slideToggle( "fast", function() {
          });


          event.preventDefault();
          var nome = $("#nome").val();
          var sobrenome = $("#sobrenome").val();
          var trabalho = $("#trabalho").val();

          $.ajax({
            url: "https://reqres.in/api/users",
            type: "POST",
            data: {
              nome: nome + " " + sobrenome + " ",
              trabalho: trabalho
            },
            success: function (response) {
              $("#retornoCreate1").text("Nome: " + response.nome);
              $("#retornoCreate2").text("| Cargo: " + response.trabalho);

            }
          })
        }





      </script>

      <!-- Bootstrap JavaScript -->
<!--   <script src="scss/jquery.min.js"></script>
-->  <script src="scss/bootstrap.bundle.min.js"></script>

<!-- Plugin jquery JavaScript -->
<script src="scss/jquery.easing.min.js"></script>
<script src="js/resume.min.js"></script>

</body>

</html>
