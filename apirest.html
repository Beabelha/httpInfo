<!DOCTYPE html>
<html lang="pt-br">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Site informativo sobre HTTP - Trabalho de redes">
  <meta name="author" content="Beabelha">

  <!-- Titulo do site --> 
  <title>HTTPINFO - REST API</title>

  <!-- CSS DO DATA TABLE -->
  <!--   <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.css"> -->

  <!-- Bootstrap CSS -->
  <link href="scss/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.20/css/dataTables.bootstrap4.min.css">

  <!-- Fontes customizaveis -->
  <link href="https://fonts.googleapis.com/css?family=Saira+Extra+Condensed:500,700" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Muli:400,400i,800,800i" rel="stylesheet">
  <link href="scss/all.min.css" rel="stylesheet">

  <!-- CSS LOCAL -->
  <link href="css/resume.min.css" rel="stylesheet">

  <!-- ICONE (FAVICON) DO SITE -->
  <link href="img/favicon.ico" rel="icon" type="image/x-icon">

  <!-- JQUERY (para o funcionamento da datatable) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

  <!-- Script da DATATABLE --> 
  <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.js"></script>

</head>

<body id="page-top">
  <!-- Barra de navegação do site de pagina unica, acha as sessões pelo ID --> 
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top" id="sideNav">
    <a class="navbar-brand js-scroll-trigger" href="#page-top">
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link js-scroll-trigger" href="index.html">Voltar</a>
        </li>
        <li class="nav-item">
          <a class="nav-link js-scroll-trigger" href="#GET">GET</a>
        </li>
        <li class="nav-item">
          <a class="nav-link js-scroll-trigger" href="#POST">POST</a>
        </li>
        <li class="nav-item">
          <a class="nav-link js-scroll-trigger" href="#PP">PUT E PATCH</a>
        </li>
        <li class="nav-item">
          <a class="nav-link js-scroll-trigger" href="#delete">DELETE</a>
        </li>
         <li class="nav-item">
          <a class="nav-link js-scroll-trigger" href="#delete">DELETE</a>
        </li>
      </ul>
    </div>
  </nav>

  <div class="container-fluid p-0">

    <section class="resume-section p-3 p-lg-5 d-flex align-items-center" id="inicio">
      <div class="w-100">
        <h1 class="mb-0">REST-
          <span class="text-primary">API</span>
        </h1>
        <div class="subheading mb-5">Consumindo a API :)
        </div>
      </div>
    </section>

    <hr class="m-0">

    <!-- Primeira sessão, o que é http --> 
    <section class="resume-section p-3 p-lg-5 d-flex justify-content-center" id="GET">
      <div class="w-100">

        <div class="resume-item d-flex flex-column flex-md-row justify-content-between mb-5">
          <div class="resume-content">
            <h2 class="mb-0">GET </h2>
            <small>Clique no botão para destravar o proximo e seguir a ordem! :)</small>
            <br>
            <small>A listagem resource e o não consta resource são exatamente iguais ao "Listar" normal, por isso não inclui.</small>
            <HR>
            <!-- DATA TABLE -->
            <div class="container">
              <div class="row">
                <div class="col-sm">
                  <div class="btn-group-vertical" role="group" aria-label="Basic example">
                    <button id="listar" type="button" class="btn btn-secondary">Listar</button>
                    <button id="listarUnico" type="button" class="btn btn-secondary" disabled>Listar Único</button>
                    <button id="naoConsta" type="button" class="btn btn-secondary" disabled>Não consta</button>
                    <button id="listarRSC" type="button" class="btn btn-secondary" disabled>Listar (rsc)</button>
                  </div>
                  
                </div>
                <span display="none" id="retornoErro"></span>
                <div id="colTable" class="col-md-8" style="display: none;">

                  <table id="dataTable" class="table table-borderless">
                    <thead>
                      <tr>
                      <!--     <th>ID</th>
                          <th>Nome</th>
                          <th>Sobrenome</th>
                          <th>Email</th> -->
                        </tr>
                      </thead>
                      <tbody id="tbody">

                      </tbody>
                    </table>


                  </div>
                  <!-- Div para dados unicos -->
                  <div id="escondida" style="display: none;">
                    <table id="unico" class="table table-bordered">
                      <tbody>
                        <tr>
                          <td id="idU"></td>
                          <td id="nameU"></td>
                          <td id="lastnU"></td>
                          <td id="emailU"></td>
                          <td><img id="avatarU"></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <div id="form" style="display: none;">
                    <!-- Span para retorno curto -->                  
                    <span id="rscunico"></span>

                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

      </section>

      <!-- Sessão do POST -->

      <section class="resume-section p-3 p-lg-5 d-flex justify-content-center" id="POST">
        <div class="w-100">

          <div class="resume-item d-flex flex-column flex-md-row justify-content-between mb-5">
            <div class="resume-content">
             <h2 class="mb-0">POST </h2>
             <small>Essa função cria um novo registro</small>
             <HR>

             <div class="container">
              <div class="row">
                <div class="col-sm">
                  <div class="btn-group-vertical" role="group" aria-label="Basic example">

                    <button id="Criar" type="button" class="btn btn-secondary">Criar</button>

                  </div>
                </div>
                <div id="formPost" style="display: none;">
                  <form method="POST">
                    <div class="form-group">
                      <label for="exampleInputEmail1">Nome</label>
                      <input name="nome" type="text" class="form-control" id="nome" aria-describedby="emailHelp">
                    </div>
                    <div class="form-group">
                      <label for="exampleInputEmail1">Sobrenome</label>
                      <input name="sobrenome" type="text" class="form-control" id="sobrenome" aria-describedby="emailHelp">
                    </div>
                    <div class="form-group">
                      <label for="exampleInputPassword1">Cargo</label>
                      <input name="trabalho" type="text" class="form-control" id="trabalho">
                    </div>
                    <button id="submit" type="submit" class="btn btn-primary">Cadastrar</button>
                  </form>    
                </div>   
                <div id="colTablePost" class="col-md-8" >

                  <div id="escondidaPost" style="display: none;">
                    <table id="unico" class="table table-bordered">
                      <thead>
                        <th>Nome</th>
                        <th>Cargo</th>
                      </thead>
                      <tbody>
                        <tr>
                          <td id="nomePost"></td>
                          <td id="cargoPost"></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>

                </div>
              </div>
            </div>

          </div>
        </div>

      </div>
    </section>

    <section class="resume-section p-3 p-lg-5 d-flex justify-content-center" id="PP">
      <div class="w-100">

        <div class="resume-item d-flex flex-column flex-md-row justify-content-between mb-5">
          <div class="resume-content">
           <h2 class="mb-0">PUT E PATCH</h2>
           <small>Essa função altera o usuário de id 2 dos registros</small>
           <HR>

           <div class="container">
            <div class="row">
              <div class="col-sm">
                <div class="btn-group-vertical" role="group" aria-label="Basic example">

                  <button id="atualizarPut" type="button" class="btn btn-secondary">Atualizar - PUT</button>
                  <button id="atualizarPatch" type="button" class="btn btn-secondary">Atualizar - Patch</button>
                </div>
              </div>
              <div id="formPP" style="display: none;">

                <span id="usuarioAntigo"></span>
                <form method="POST">
                  <div class="form-group">
                    <label for="exampleInputEmail1">Nome</label>
                    <input name="nomePP" type="text" class="form-control" id="nomePP" aria-describedby="emailHelp">
                  </div>

                  <div class="form-group">
                    <label for="exampleInputPassword1">Cargo</label>
                    <input name="trabalhoPP" type="text" class="form-control" id="trabalhoPP">
                  </div>
                  <button id="submitPP" type="submit" class="btn btn-primary">Alterar</button>
                </form>    
              </div>   
              <div id="colTablePost" class="col-md-8" >

                <!-- DATA TABLE -->
              </div>
              <div id="escondidaPP" style="display: none;">
                <table id="unico" class="table table-bordered">
                  <tbody>
                    <tr>
                      <td id="nomeP"></td>
                      <td id="cargoP"></td>
                    </tr>
                  </tbody>
                </table>
              </div>

            </div>
          </div>

        </div>
      </div>

    </div>

  </div>
</section>

<section class="resume-section p-3 p-lg-5 d-flex justify-content-center" id="delete">
  <div class="w-100">

    <div class="resume-item d-flex flex-column flex-md-row justify-content-between mb-5">
      <div class="resume-content">
       <h2 class="mb-0">delete</h2>
       <small>Essa função apenas exclui o usuário de id 2 dos registros</small>
       <HR>

       <div class="container">
        <div class="row">
          <div class="col-sm">
            <div class="btn-group-vertical" role="group" aria-label="Basic example">
              <button id="deletar" type="button" class="btn btn-secondary">Deletar</button>
            </div>
          </div>

        </div> 

        <div id="colTableDelete" class="col-md-8" >
          <SPAN id="deletado"></SPAN>
        </div>

      </div>
    </div>

  </div>
</div>

</div>

</div>
</section>
<!-- Script da REST API -->

<script type="text/javascript">
 var xhr = new XMLHttpRequest();


     //Listar todos os usuários
     document.getElementById("listar").onclick = function(){
      document.getElementById("listarUnico").disabled = false;
      $( "#colTable" ).slideToggle( "fast", function() {
      });

      $.ajax({

        url: "https://reqres.in/api/users/2",
        type: "GET",

        success: function(response){
          $('#dataTable').DataTable( {
            ajax:  "https://reqres.in/api/users",
            columns: [
            { "data" : "first_name"},
            { "data" : "last_name"},
            { "data" : "email"},]
          });
          setTimeout(function(){ 
            $('#dataTable').dataTable().fnDestroy();
            $('#tbody').empty();
          }, 3000); 
        }
      });
    };

     //Listar usuário único
     document.getElementById("listarUnico").onclick = function(){
      document.getElementById("listar").disabled = true;
      document.getElementById("naoConsta").disabled = false;

       $('#dataTable').dataTable().fnDestroy();
        $('#tbody').empty();
      $( "#colTable" ).slideToggle( "fast", function() {
      });
      $( "#escondida" ).toggle();

      $.ajax({
        url: "https://reqres.in/api/users/2",
        type: "GET",

        success: function (response) {
          $("#nameU").text(response.data.first_name);
          $("#lastnU").text(response.data.last_name);
          $("#avatarU").attr('src', response.data.avatar);
          $("#emailU").text(response.data.email);
        }
      });
    };

    //404
    document.getElementById("naoConsta").onclick = function () {
      document.getElementById("listarUnico").disabled = true;

      document.getElementById("listarRSC").disabled = false;

      document.getElementById("unico").innerHTML = null;

      $('#dataTable').dataTable().fnDestroy();

      $( "#returnoErro" ).slideToggle( "slow", function() {
      });
      $.ajax({
        url: "https://reqres.in/api/users/23",
        type: "GET",

        statusCode: {
          404: function () {
           $("#retornoErro").text("Usuário não consta no sistema");
           setTimeout(function(){ 
            $("#retornoErro").text("");
          }, 3000); 
         }
       }
     });
    };

         //Listar todos os usuários RESOURCE
         document.getElementById("listarRSC").onclick = function(){

          document.getElementById("naoConsta").disabled = true;

          $('#dataTable').dataTable().fnDestroy();

          $( "#colTable" ).slideToggle( "slow", function() {
          });

          $.ajax({

            url: "https://reqres.in/api/unknowwn",
            type: "GET",

            success: function(response){
              $('#dataTable').DataTable( {
                ajax:  "https://reqres.in/api/unknowwn/",
                columns: [
                { "data" : "name"},
                { "data" : "color"},
                { "data" : "year"},]
              });
            }
          });
        };

        //Create com POST
        document.getElementById("Criar").onclick = function(){
         $('#formPost').animate({width: 'toggle'});
       };

       document.getElementById("submit").onclick = function () {
        $( "#formPost" ).slideToggle( "fast", function() {
        });

        event.preventDefault();
        var nome = $("#nome").val();
        var sobrenome = $("#sobrenome").val();
        var trabalho = $("#trabalho").val();

        $.ajax({
          url: "https://reqres.in/api/users",
          type: "POST",
          data: {
            nome: nome + " " + sobrenome + " ",
            trabalho: trabalho
          },
          success: function (response) {
           $( "#escondidaPost" ).slideToggle( "fast", function() {
           });
           $("#nomePost").text(response.nome);
           $("#cargoPost").text(response.trabalho);
         }
       })
      };


      //UPDATE COM PUT
      document.getElementById("atualizarPut").onclick = function(){
       $('#formPP').animate({width: 'toggle'});
     };
     document.getElementById("submitPP").onclick = function () {
      $( "#formPP" ).slideToggle( "fast", function() {
      });
      event.preventDefault();
      var nome = $("#nomePP").val();
      var trabalho = $("#trabalhoPP").val();

      $.ajax({
        url: "https://reqres.in/api/users/2",
        type: "PUT",
        data: {
          nome: nome,
          trabalho: trabalho
        },
        success: function (response) {
         $( "#escondidaPP" ).slideToggle( "fast", function() {
         });
         $("#nomeP").text(response.nome);
         $("#cargoP").text(response.trabalho);

         setTimeout(function(){ 
           $( "#escondidaPP" ).slideToggle( "fast", function() {
           });
           $("#nomeP").text("");
           $("#cargoP").text("");
         }, 5000); 
       }
     })
    };

    //UPDATE COM PATCH
    document.getElementById("atualizarPatch").onclick = function(){
     $('#formPP').animate({width: 'toggle'});
   };


   document.getElementById("submitPP").onclick = function () {
    $( "#formPP" ).slideToggle( "fast", function() {
    });


    event.preventDefault();
    var nome = $("#nomePP").val();
    var trabalho = $("#trabalhoPP").val();

    $.ajax({
      url: "https://reqres.in/api/users/2",
      type: "PATCH",
      data: {
        nome: nome,
        trabalho: trabalho
      },
      success: function (response) {
       $( "#escondidaPP" ).slideToggle( "fast", function() {
       });
       $("#nomeP").text(response.nome);
       $("#cargoP").text(response.trabalho);

       setTimeout(function(){ 
         $( "#escondidaPP" ).slideToggle( "fast", function() {
         });
         $("#nomeP").text("");
         $("#cargoP").text("");

       }, 5000); 


     }
   })
  }

           //Deleta o usuário de ID número 2 dos registros
           document.getElementById("deletar").onclick = function(){      

            $.ajax({
              url: "https://reqres.in/api/users/2",
              type: "DELETE",

              statusCode: {
                204: function () {
                  $("#deletado").text("Excluido com sucesso");
                }
              }
            });
          }
          
          



        </script>

        <!-- Bootstrap JavaScript -->
<!--   <script src="scss/jquery.min.js"></script>
-->  <script src="scss/bootstrap.bundle.min.js"></script>

<!-- Plugin jquery JavaScript -->
<script src="scss/jquery.easing.min.js"></script>
<script src="js/resume.min.js"></script>

</body>

</html>
